//Project MineWorld Dog v1
{
   "format_version": "1.16.0",
   "minecraft:entity": {
       "description": {
            "identifier": "mineworld:wolfdog",
            "is_spawnable": true, "is_summonable": true, "is_experimental": false
       },
       "component_groups": {
            //#region States
           "wolfdog:baby": {
                "minecraft:is_baby": {},
                "minecraft:health": { "value": 8 },
                "minecraft:attack": { "damage": 1 },
                "minecraft:scale": { "value": 0.5 },
                "minecraft:ageable": {
                    "duration": 1200,
                    "feed_items": [
                        "chicken", "cooked_chicken",
                        "beef", "cooked_beef",
                        "muttonRaw", "muttonCooked",
                        "porkchop", "cooked_porkchop",
                        "rabbit", "cooked_rabbit",
                        "rotten_flesh"
                    ],
                    "grow_up": { "event": "minecraft:ageable", "target": "self" }
                },               
                "minecraft:behavior.follow_parent": { "priority": 2, "speed_multiplier": 1 }
            },
            "wolfdog:adult": {
                "minecraft:breedable": {
                    "require_tame": true,
                    "inherit_tamed": true,
                    "breeds_with": {
                        "mate_type": "mineworld:wolfdog", "baby_type": "mineworld:wolfdog",
                        "breed_event": { "event": "minecraft:entity_born", "target": "baby" }
                    },
                    "breed_items": [
                        "chicken", "cooked_chicken",
                        "beef", "cooked_beef",
                        "muttonRaw", "muttonCooked",
                        "porkchop", "cooked_porkchop",
                        "rabbit", "cooked_rabbit",
                        "rotten_flesh"
                    ],
                    "extra_baby_chance": 0.1875, // 3/8
                    "breed_cooldown": 3
                },
                "minecraft:experience_reward": {
                    "on_bred": "Math.Random(1,4)",
                    "on_death": "query.last_hit_by_player ? 2 + (query.equipment_count * Math.Random(1,2)) : 0"
                }
            },
            //#endregion
            //#region Tame-Wild
            "wolfdog:wild": {
                "minecraft:health": { "value": 14 },
                "minecraft:tameable": {
                    "probability": 0.3,
                    "tame_items": "bone",
                    "tame_event": { "event": "minecraft:tameable", "target": "self" }
                },
                "minecraft:behavior.nearest_attackable_target": {
                    "priority": 4,
                    "attack_interval": 10,
                    "reselect_targets": true,
                    "entity_types": [
                        {
                            "filters": {
                                "any_of": [
                                    { "test": "is_family", "subject": "other", "value": "skeleton" },
                                    { "test": "is_family", "subject": "other", "value": "rabbit" }
                                ]
                            },
                            "max_dist": 16
                        }
                    ],
                    "must_see": true
                },
               
                "minecraft:behavior.tempt": {
                    "priority": 5,
                    "speed_multiplier": 0.5,
                    "within_radius": 16,
                    "can_get_scared": true,
                    "items": [
                        "chicken", "cooked_chicken",
                        "beef", "cooked_beef",
                        "muttonRaw", "muttonCooked",
                        "porkchop", "cooked_porkchop",
                        "rabbit", "cooked_rabbit",
                        "rotten_flesh"
                    ]
                },
                "minecraft:behavior.avoid_mob_type": {
                    "priority": 6,
                        "entity_types": [
                            { "filters": { "test": "is_family", "subject": "other", "value": "player" },
                            "max_dist": 10,
                            "walk_speed_multiplier": 0.8,
                            "sprint_speed_multiplier": 1.33
                        }
                    ]
                }
            },
            "wolfdog:tamed": {
                "minecraft:is_tamed": {},
                "minecraft:sittable": {},
                "minecraft:attack": { "damage": 4 },
                "minecraft:health": { "value": 16 },
                
                "minecraft:behavior.owner_hurt_by_target": { "priority": 1 },
                "minecraft:behavior.breed": { "priority": 2 },
                "minecraft:behavior.owner_hurt_target": { "priority": 2 },
                "minecraft:behavior.nearest_attackable_target": {
                    "priority": 5,
                    "attack_interval": 10,
                    "entity_types": [
                        {
                            "filters": { "test": "is_family", "subject": "other", "value": "skeleton" },
                            "max_dist": 16
                        }
                    ],
                    "must_see": true
                },
                "minecraft:behavior.follow_owner": {
                    "priority": 6,
                    "speed_multiplier": 1,
                    "start_distance": 10,
                    "stop_distance": 2
                },

                "minecraft:leashable": {
                    "soft_distance": 4,
                    "hard_distance": 6,
                    "max_distance": 10,
                    "on_leash": { "event": "minecraft:on_leash", "target": "self" },
                    "on_unleash": { "event": "minecraft:on_unleash", "target": "self" }
                }
            },
            //#endregion
            //#region Behaviors
            "dog:behavior.happy": {
                "minecraft:environment_sensor": {
                    "triggers": {
                        "filters": { "test": "clock_time", "operator": "==", "value": 0.8 },
                        "event": "mineworld:gift"
                    }
                }
            },
            "dog:behavior.aggresive": {
                "minecraft:behavior.nearest_attackable_target": {
                    "attack_interval": 15,
                    "scan_interval": 40,
                    "within_radius": 5,
                    "entity_types": {
                        "filters": {
                            "all_of": [
                                { "test": "is_family", "subject": "other", "value": "dog" },
                                { "test": "has_component", "subject": "other", "operator": "!=", "value": "minecraft:is_baby" }
                            ]
                        }
                    }
                }
            },
            "dog:behavior.weak": {
                "minecraft:health": { "value": 5 },
                "minecraft:movement": { "value": 0.2 }
            },

            "dog:behavior.neutral": {},

            "dog:gift": {
                "minecraft:behavior.drop_item_for": {
                    "drop_item_chance": 0.05,
                    "loot_table": "loot_tables/entities/dogGift.json",
                    "entity_types": {
                        "filters": {
                            "all_of": [
                                { "test": "is_family", "subject": "other", "value": "player" },
                                { "test": "has_component", "subject": "self", "value": "minecraft:is_tamed" }
                            ]
                        }
                    },
                    "time_of_day_range": [ 0.8, 0.85 ],
                    "on_drop_attemp": "mineworld:unGift"
                }
            },
            //#endregion
            //#region Eyes
            "wolfdog:eye.brown": { "minecraft:variant": { "value": 0 } },
            "wolfdog:eye.brown_1": { "minecraft:variant": { "value": 1 } }, //blue_light
            "wolfdog:eye.brown_2": { "minecraft:variant": { "value": 2 } } //black
            //#endregion
       },
       "components": {
        "minecraft:type_family": { "family": [ "dog", "wolfdog", "hybrid" ] },
        "minecraft:nameable": {},
        "minecraft:movement": { "value": 0.25 },
        "minecraft:breathable": { "total_supply": 15, "suffocate_time": 0 },
        "minecraft:hurt_on_condition": {
            "damage_conditions": [
                {
                    "filters": { "test": "in_lava", "subject": "self", "operator": "==", "value": true },
                    "cause": "lava",
                    "damage_per_tick": 4
                }
            ]
        },
        "minecraft:navigation.walk": { "can_path_over_water": true, "avoid_damage_blocks": true },
        "minecraft:movement.basic": {},
        "minecraft:jump.static": {},
        "minecraft:can_climb": {},
        "minecraft:healable": {
            "items": [
                { "item": "porkchop", "heal_amount": 3 },
                { "item": "cooked_porkchop", "heal_amount": 8 },
                { "item": "fish", "heal_amount": 2 },
                { "item": "salmon", "heal_amount": 2 },
                { "item": "clownfish", "heal_amount": 1 },
                { "item": "pufferfish", "heal_amount": 1 },
                { "item": "cooked_fish", "heal_amount": 5 },
                { "item": "cooked_salmon", "heal_amount": 6 },
                { "item": "beef", "heal_amount": 3 },
                { "item": "cooked_beef", "heal_amount": 8 },
                { "item": "chicken", "heal_amount": 2 },
                { "item": "cooked_chicken", "heal_amount": 6 },
                { "item": "muttonRaw", "heal_amount": 2 },
                { "item": "muttonCooked", "heal_amount": 6 },
                { "item": "rotten_flesh", "heal_amount": 4 },
                { "item": "rabbit", "heal_amount": 3 },
                { "item": "cooked_rabbit", "heal_amount": 5 },
                { "item": "rabbit_stew", "heal_amount": 10 }
            ]
        },
        //#region Behaviors
        "minecraft:behavior.float": { "priority": 0 },
        "minecraft:behavior.mount_pathing": {
            "priority": 1,
            "speed_multiplier": 1.25,
            "target_dist": 0,
            "track_target": true
        },
        "minecraft:behavior.hurt_by_target": { "priority": 3 },
        "minecraft:behavior.stay_while_sitting": { "priority": 3 },
        "minecraft:behavior.leap_at_target": {
            "priority": 4,
            "target_dist": 0.4
        },
        "minecraft:behavior.melee_attack": {
            "priority": 5,
            "target_dist": 1.2,
            "track_target": true,
            "reach_multiplier": 1
        },
        "minecraft:behavior.look_at_player": {
            "priority": 6,
            "target_distance": 6,
            "probability": 0.02
        },
        "minecraft:behavior.random_stroll": {
            "priority": 8,
            "speed_multiplier": 1
        },
        "minecraft:behavior.beg": {
            "priority": 9,
            "look_distance": 8,
            "look_time": [ 2, 4 ],
            "items": [
               "bone", "rotten_flesh",
               "porkchop", "cooked_porkchop",
               "chicken", "cooked_chicken",
               "beef", "cooked_beef",
               "muttonraw", "muttoncooked",
               "rabbit", "cooked_rabbit"
            ]
        },
        //#endregion
        "minecraft:despawn": { "despawn_from_distance": { "max_distance": 128, "min_distance": 32 } },
        "minecraft:pushable": { "is_pushable": true, "is_pushable_by_piston": true },
        "minecraft:physics": {}
       },

        "events": {
            "minecraft:entity_spawned": {
                "sequence": [
                    {
                        "randomize": [
                            {
                                "weight": 85,
                                "add": { "component_groups": [ "wolfdog:adult", "wolfdog:wild" ] }
                            },
                            {
                                "weight": 15,
                                "add": { "component_groups": [ "wolfdog:baby", "wolfdog:wild" ] }
                            }
                        ]
                    },
                    {
                        "randomize": [
                            {
                                "weight": 95,
                                "add": { "component_groups": [ "dog:behavior.neutral" ] }
                            },
                            {
                                "weight": 10,
                                "add": { "component_groups": [ "dog:behavior.happy" ] }
                            },
                            {
                                "weight": 10,
                                "add": { "component_groups": [ "dog:behavior.aggresive" ] }
                            },
                            {
                                "weight": 5,
                                "add": { "component_groups": [ "dog:behavior.weak" ] }
                            }
                        ]
                    },
                    {
                        "randomize": [
                            {
                                "weight": 1,
                                "add": { "component_groups": [ "wolfdog:eye.brown" ] }
                            },
                            {
                                "weight": 1,
                                "add": { "component_groups": [ "wolfdog:eye.brown_1" ] }
                            },
                            {
                                "weight": 1,
                                "add": { "component_groups": [ "wolfdog:eye.brown_2" ] }
                            }
                        ]
                    }
                ]
            },
            "minecraft:entity_born": { "add": { "component_groups": [ "wolfdog:baby", "wolfdog:tamed" ] } },
            "minecraft:ageable": {
                "add": { "component_groups": [ "wolfdog:adult" ] },
                "remove": { "component_groups": [ "wolfdog:baby" ] }
            },
            "minecraft:tameable": {
                "add": { "component_groups": [ "wolfdog:tamed" ] },
                "remove": { "component_groups": [ "wolfdog:wild" ] }
            },

            "mineworld:gift": { "add": { "component_groups": [ "dog:gift" ] } },
            "mineworld:unGift": { "remove": { "component_groups": [ "dog:gift" ] } }
        }
    }
}