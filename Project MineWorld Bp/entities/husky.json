//Project MineWorld Dog v2
{
   "format_version": "1.16.0",
   "minecraft:entity": {
      "description": {
         "identifier": "mineworld:husky",
         "is_spawnable": true, "is_summonable": true, "is_experimental": false
      },
      "component_groups": {
         //#region States
         "dog:baby": {
            "minecraft:is_baby": {},
            "minecraft:health": { "value": 11 },
            "minecraft:attack": { "damage": 1 },
            "minecraft:scale": { "value": 0.7 },
            "minecraft:ageable": {
               "duration": 1200,
               "feed_items": [
                  "chicken", "cooked_chicken",
                  "beef", "cooked_beef",
                  "muttonRaw", "muttonCooked",
                  "porkchop", "cooked_porkchop",
                  "rabbit", "cooked_rabbit",
                  "rotten_flesh"
               ],
               "grow_up": { "event": "minecraft:ageable", "target": "self" }
            },
            "minecraft:behavior.follow_parent": { "priority": 2, "speed_multiplier": 1 }
         },
         "dog:adult": {
            "minecraft:scale": { "value": 1.4 },
            "minecraft:breedable": {
               "require_tame": true,
               "inherit_tamed": true,
               "breeds_with": [
                  {
                     "mate_type": "mineworld:husky", "baby_type": "mineworld:husky",
                     "breed_event": { "event": "minecraft:entity_born", "target": "baby" }
                  },
                  {
                     "mate_type": "minecraft:wolf", "baby_type": "mineworld:wolfdog",
                     "breed_event": { "event": "minecraft:entity_born", "target": "baby" }
                  }
               ],
               "breed_items": [
                  "chicken", "cooked_chicken",
                  "beef", "cooked_beef",
                  "muttonRaw", "muttonCooked",
                  "porkchop", "cooked_porkchop",
                  "rabbit", "cooked_rabbit",
                  "rotten_flesh"
               ],
               "extra_baby_chance": 0.375, // 3/8
               "mutation_factor": { "extra_variant": 0.05 }, //5%
               "breed_cooldown": 3
            },
            "minecraft:experience_reward": {
               "on_bred": "Math.Random(1,4)",
               "on_death": "query.last_hit_by_player ? 2 + (query.equipment_count * Math.Random(1,2)) : 0"
            }
         },
         //#endregion
         //#region Wild-Tame
         "dog:wild": {
               "minecraft:tameable": {
                  "probability": 0.2, // 1/5
                  "tame_items": "bone",
                  "tame_event": { "event": "minecraft:tameable", "target": "self" }
               },
               "minecraft:health": { "value": 16 },
               "minecraft:behavior.nearest_attackable_target": {
                  "priority": 4,
                  "attack_interval": 10,
                  "reselect_targets": true,
                  "must_see": true,
                  "entity_types": [
                     {
                           "filters": {
                              "any_of": [
                                 { "test": "is_family", "subject": "other", "value": "skeleton" },
                                 { "test": "is_family", "subject": "other", "value": "rabbit" },
                                 { "test": "is_family", "subject": "other", "value": "sheep" }
                              ]
                           },
                           "max_dist": 16
                     }
                  ]
               }
         },
         "dog:tamed": {
               "minecraft:is_tamed": {},
               "minecraft:sittable": {},
               "minecraft:health": { "value": 16 },
               "minecraft:attack": { "damage": 4 },
               
               "minecraft:behavior.owner_hurt_by_target": { "priority": 1 },
               "minecraft:behavior.owner_hurt_target": { "priority": 2 },
               "minecraft:behavior.breed": { "priority": 2 },
               "minecraft:behavior.nearest_attackable_target": {
                  "priority": 5,
                  "attack_interval": 10,
                  "entity_types": [
                     {
                           "filters": { "test": "is_family", "subject": "other", "value": "skeleton" },
                           "max_dist": 16
                     }
                  ],
                  "must_see": true
               },
               "minecraft:behavior.follow_owner": {
                  "priority": 6,
                  "speed_multiplier": 1,
                  "start_distance": 10,
                  "stop_distance": 2
               },
               
               "minecraft:leashable": {
                  "soft_distance": 4,
                  "hard_distance": 6,
                  "max_distance": 10,
                  "on_leash": { "event": "minecraft:on_leash", "target": "self" },
                  "on_unleash": { "event": "minecraft:on_unleash", "target": "self" }
               }
         },
         //#endregion
         //#region Behaviors
         "dog.timer:behavior_changer": {
            "minecraft:timer": {
                "looping": true,
                "randomInterval": true,
                "time": [ 60, 180 ],
                "time_down_event": { "event": "mineworld:behavior_change" }
            }
         },
         "dog.behavior:neutral": {},
         "dog.behavior:happy": {
            "minecraft:environment_sensor": {
                "triggers": {
                  "filters": { "test": "clock_time", "operator": "==", "value": 0.8 },
                  "event": "mineworld:gift"
               }
            }
         },
         "dog.behavior:aggresive": {
            "minecraft:behavior.nearest_attackable_target": {
               "attack_interval": 15,
               "scan_interval": 40,
               "within_radius": 5,
               "entity_types": {
                    "filters": {
                        "all_of": [
                            { "test": "is_family", "subject": "other", "value": "dog" },
                            { "test": "has_component", "subject": "other", "operator": "!=", "value": "minecraft:is_baby" }
                        ]
                    }
                }
            }
        },
        "dog.behavior:weak": {
            "minecraft:health": { "value": 5 },
            "minecraft:movement": { "value": 0.2 }
        },
        
        "dog:gift": {
            "minecraft:behavior.drop_item_for": {
                "drop_item_chance": 0.05,
                "loot_table": "loot_tables/entities/dogGift.json",
                "entity_types": {
                    "filters": {
                        "all_of": [
                            { "test": "is_family", "subject": "other", "value": "player" },
                            { "test": "has_component", "subject": "self", "value": "minecraft:is_tamed" }
                        ]
                    }
                },
                "time_of_day_range": [ 0.8, 0.85 ],
                "on_drop_attemp": "mineworld:unGift"
            }
        },
        //#endregion
         //#region Eyes
         "dog.eye:black": { "minecraft:mark_variant": { "value": 0 } },
         "dog.eye:black.right": { "minecraft:mark_variant": { "value": 1 } },
         "dog.eye:black.left": { "minecraft:mark_variant": { "value": 2 } },

         "dog.eye:blue": { "minecraft:mark_variant": { "value": 3 } },
         "dog.eye:blue.right": { "minecraft:mark_variant": { "value": 4 } },
         "dog.eye:blue.left": { "minecraft:mark_variant": { "value": 5 } },

         "dog.eye:brown": { "minecraft:mark_variant": { "value": 6 } },
         "dog.eye:brown.right": { "minecraft:mark_variant": { "value": 7 } },
         "dog.eye:brown.left": { "minecraft:mark_variant": { "value": 8 } }
         //#endregion
      },
      "components": {
         "minecraft:nameable": {},
         "minecraft:type_family": { "family": [ "dog", "husky" ] },
         "minecraft:movement": { "value": 0.25 },
         "minecraft:collision_box": { "width": 0.6, "height": 0.8 },
         "minecraft:breathable": { "total_supply": 15, "suffocate_time": 0 },
         "minecraft:hurt_on_condition": {
             "damage_conditions": [
                 {
                     "filters": { "test": "in_lava", "subject": "self", "operator": "==", "value": true },
                     "cause": "lava",
                     "damage_per_tick": 4
                 }
             ]
         },
         "minecraft:navigation.walk": {
             "can_path_over_water": true,
             "avoid_damage_blocks": true
         },
         "minecraft:movement.basic": {},
         "minecraft:jump.static": {},
         "minecraft:can_climb": {},
         "minecraft:healable": {
             "items": [
                 { "item": "porkchop", "heal_amount": 3 },
                 { "item": "cooked_porkchop", "heal_amount": 8 },
                 { "item": "fish", "heal_amount": 2 },
                 { "item": "salmon", "heal_amount": 2 },
                 { "item": "clownfish", "heal_amount": 1 },
                 { "item": "pufferfish", "heal_amount": 1 },
                 { "item": "cooked_fish", "heal_amount": 5 },
                 { "item": "cooked_salmon", "heal_amount": 6 },
                 { "item": "beef", "heal_amount": 3 },
                 { "item": "cooked_beef", "heal_amount": 8 },
                 { "item": "chicken", "heal_amount": 2 },
                 { "item": "cooked_chicken", "heal_amount": 6 },
                 { "item": "muttonRaw", "heal_amount": 2 },
                 { "item": "muttonCooked", "heal_amount": 6 },
                 { "item": "rotten_flesh", "heal_amount": 4 },
                 { "item": "rabbit", "heal_amount": 3 },
                 { "item": "cooked_rabbit", "heal_amount": 5 },
                 { "item": "rabbit_stew", "heal_amount": 10 }
             ]
         },
         //#region Behaviors
         "minecraft:behavior.float": { "priority": 0 },
         "minecraft:behavior.mount_pathing": {
             "priority": 1,
             "speed_multiplier": 1.25,
             "target_dist": 0,
             "track_target": true
         },
         "minecraft:behavior.hurt_by_target": { "priority": 3 },
         "minecraft:behavior.stay_while_sitting": { "priority": 3 },
         "minecraft:behavior.leap_at_target": {
             "priority": 4,
             "target_dist": 0.4
         },
         "minecraft:behavior.melee_attack": {
             "priority": 5,
             "target_dist": 1.2,
             "track_target": true,
             "reach_multiplier": 1
         },
         "minecraft:behavior.look_at_player": {
             "priority": 6,
             "target_distance": 6,
             "probability": 0.02
         },
         "minecraft:behavior.random_stroll": {
             "priority": 8,
             "speed_multiplier": 1
         },
         "minecraft:behavior.beg": {
             "priority": 9,
             "look_distance": 8,
             "look_time": [ 2, 4 ],
             "items": [
                "bone", "rotten_flesh",
                "porkchop", "cooked_porkchop",
                "chicken", "cooked_chicken",
                "beef", "cooked_beef",
                "muttonraw", "muttoncooked",
                "rabbit", "cooked_rabbit"
             ]
         },
         //#endregion
         "minecraft:genetics": {
            "genes": [
               {
                  "name": "eyeColor",
                  "allele_range": { "range_min": 0, "range_max": 20 },
                  "genetic_variants": [
                     {
                        "birth_event": {
                           "event": "mineworld:eye.black",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 0, "range_max": 2 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.black.left",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 3, "range_max": 4 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.black.right",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 5, "range_max": 6 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.blue",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 7, "range_max": 9 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.blue.left",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 10, "range_max": 11 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.blue.right",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 12, "range_max": 13 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.brown",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 14, "range_max": 16 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.brown.left",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 17, "range_max": 18 }
                     },
                     {
                        "birth_event": {
                           "event": "mineworld:eye.brown.right",
                           "target": "self"
                        },
                        "both_allele": { "range_min": 19, "range_max": 20 }
                     }
                  ]
               }
            ],
            "mutation_rate": 0.0625
         },
         "minecraft:despawn": { "despawn_from_distance": { "max_distance": 128, "min_distance": 32 } },
         "minecraft:pushable": { "is_pushable": true, "is_pushable_by_piston": true },
         "minecraft:conditional_bandwidth_optimization": {},
         "minecraft:physics": {}
      },
     "events": {
         "minecraft:entity_spawned": {
            "sequence": [
               {
                  "randomize": [
                     {
                         "weight": 85,
                         "add": { "component_groups": [ "dog:wild", "dog:adult", "dog.behavior:neutral", "dog.timer:behavior_changer" ] }
                     },
                     {
                         "weight": 15,
                         "add": { "component_groups": [ "dog:wild", "dog:baby", "dog.behavior:neutral", "dog.timer:behavior_changer" ] }
                     }
                 ]
               },
               {
                  "randomize": [
                     {
                        "weight": 30,
                        "add": { "component_groups": [ "dog.eye:black" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:black.left" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:black.right" ] }
                     },
                     {
                        "weight": 30,
                        "add": { "component_groups": [ "dog.eye:blue" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:blue.left" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:blue.right" ] }
                     },
                     {
                        "weight": 30,
                        "add": { "component_groups": [ "dog.eye:brown" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:brown.left" ] }
                     },
                     {
                        "weight": 15,
                        "add": { "component_groups": [ "dog.eye:brown.right" ] }
                     }
                 ]
               }
            ]
             
         },
         "minecraft:entity_born": { "add": { "component_groups": [ "dog:baby", "dog:tamed", "dog.behavior:happy" ] } },
         "minecraft:ageable": {
             "add": { "component_groups": [ "dog:adult" ] },
             "remove": { "component_groups": [ "dog:baby" ] }
         },
         "minecraft:tameable": {
             "add": { "component_groups": [ "dog:tamed" ] },
             "remove": { "component_groups": [ "dog:wild" ] }
         },

         "mineworld:gift": { "add": { "component_groups": [ "dog:gift" ] } },
         "mineworld:unGift": { "remove": { "component_groups": [ "dog:gift" ] } },

         "mineworld:behavior_change": {
            "sequence": [
               { "remove": { "component_groups": [ "dog.behavior:neutral", "dog.behavior:happy", "dog.behavior:aggresive", "dog.behavior:weak" ] } },
               {
                  "randomize": [
                     {
                        "weight": 50,
                        "add": { "component_groups": [ "dog.behavior:neutral" ] }
                     },
                     {
                        "weight": 30,
                        "add": { "component_groups": [ "dog.behavior:happy" ] }
                     },
                     {
                        "weight": 22,
                        "add": { "component_groups": [ "dog.behavior:aggresive" ] }
                     },
                     {
                        "weight": 10,
                        "add": { "component_groups": [ "dog.behavior:weak" ] }
                     }
                  ]
               }
            ]
         },

         "mineworld:eye.black": { "add": { "component_groups": [ "dog.eye:black" ] } },
         "mineworld:eye.black.left": { "add": { "component_groups": [ "dog.eye:black.left" ] } },
         "mineworld:eye.black.right": { "add": { "component_groups": [ "dog.eye:black.right" ] } },

         "mineworld:eye.blue": { "add": { "component_groups": [ "dog.eye:blue" ] } },
         "mineworld:eye.blue.left": { "add": { "component_groups": [ "dog.eye:blue.left" ] } },
         "mineworld:eye.blue.right": { "add": { "component_groups": [ "dog.eye:blue.right" ] } },

         "mineworld:eye.brown": { "add": { "component_groups": [ "dog.eye:brown" ] } },
         "mineworld:eye.brown.left": { "add": { "component_groups": [ "dog.eye:brown.left" ] } },
         "mineworld:eye.brown.right": { "add": { "component_groups": [ "dog.eye:brown.right" ] } }
      }
   }
}
